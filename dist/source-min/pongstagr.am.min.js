/*! ==========================================================================
 * pongstagr.am v3.0.4 jQuery Plugin | http://pongstr.github.io/pongstagr.am/
 * ===========================================================================
 * Copyright (c) 2014 Pongstr Ordillo. Licensed under MIT License.
 * =========================================================================== */

+function(t){"use strict";var e=function(t,e){return this.element=t,this.options=e,this};e.defaults={accessId:null,accessToken:null,count:8,likes:!0,comments:!0,timestamp:!0,username:!0,effects:"scaling",show:"recent",preload:"spinner",button:"btn btn-success pull-right",buttontext:"Load more",column:"col-xs-12 col-sm-3 col-md-3 col-lg-3",likeicon:"glyphicon glyphicon-heart",muteicon:"glyphicon glyphicon-volume-off",videoicon:"glyphicon glyphicon-play",commenticon:"glyphicon glyphicon-comment",picture_size:64,show_counts:!0,profile_bg_img:null,profile_bg_color:"#d9534f"},e.prototype.template={loadmore:function(e){var a='<div class="row">';a+='  <button class="'+e.button+'" data-paginate="'+e.show+'">',a+=e.buttontext,a+="  </button>",a+="</div>","before"!==e.insert?t(e.target).after(a):t(e.target).before(a)},profile:function(e){var a='<div class="row pongstgrm-profile">';a+=' <div class="col-xs-12 text-center">',a+='   <div class="thumbnail">',a+='     <img src="'+e.profile_picture+'" width="'+e.picture_size+'"  height="'+e.picture_size+'" alt="'+e.username+'">',a+="   </div>",a+='   <div class="counts">',a+='     <span class="h4">'+e.media+" <small>Posts</small></span>",a+='     <span class="h4">'+e.followed_by+" <small>Followers</small></span>",a+='     <span class="h4">'+e.follows+" <small>Following</small></span>",a+="   </div>",a+='   <div class="user-data">',a+="     <h3>"+e.username+"</h3>",a+="     <small>"+e.full_name+' - <a href="'+e.website+'">'+e.website+"</a></small>",a+="     <p>"+e.bio+"</p>",a+="   </div>",a+=" </div>",a+="</div>",t(e.target).append(a).css({"background-image":"url("+e.profile_bg_img+")","background-color":e.profile_bg_color})},thumb:function(e){var a='<div class="'+e.dflt.column+'">';a+=' <div class="thumbnail text-center '+e.dflt.effects+'">',e.dflt.timestamp!==!1?a+="<strong>"+e.data.timestamp+"</strong>":null,a+='   <div class="'+e.dflt.preload+'" id="'+e.dflt.show+"-"+e.data.id+'-thmb-loadr" />',a+='   <a href="#'+e.data.id+'" id="triggr-'+e.data.id+'">',a+='     <img id="'+e.dflt.show+"-"+e.data.id+'-thmb" src="'+e.data.thumbnail+'" alt="'+e.data.caption+'">',a+="   </a>","video"===e.data.type?a+='<span class="type"><i class="'+e.dflt.videoicon+'"></i></span>':"",e.data.likes!==!1?a+='<div class="username">@'+e.data.username+"</div>":"",e.data.likes!==!1?a+='<span class="likes"><i class="'+e.dflt.likeicon+'"></i>&nbsp; '+e.data.likes_count+"</span>":"",e.data.comments!==!1?a+='<span class="comments"><i class="'+e.dflt.commenticon+'"></i>&nbsp; '+e.data.comments_count+"</span>":"",a+=" </div>",a+="</div>",t(e.target).append(a)},bsmodal:function(a){var o='<div class="alert">Your browser does not support HTML5 Videos or MPEG-4 format.</div>',i='<div class="'+a.dflt.preload+'" id="'+a.data.id+'-full-loadr"></div>';i+='<img id="'+a.data.id+'-full" src="'+a.data.image+'" alt="'+a.data.caption+'">';var s='<video id="'+a.data.id+'-video" width="100%" height="auto">';s+='  <source src="'+a.data.video+'" type="video/mp4">',s+=o,s+="</video>",s+='<button type="button" class="btn btn-lg" id="play-pause"><i class="glyphicon glyphicon-play"></i></button>',s+='<button type="button" class="btn btn-lg" id="mute"><i class="glyphicon glyphicon-volume-up"></i></button>';var l='<div id="'+a.data.id+'" class="modal fade">';l+='  <div class="modal-dialog">',l+='    <div class="modal-content">',l+='      <div class="modal-body">',l+='        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>',l+='        <div class="row">',l+='<div class="media-column">',l+="video"!==a.data.type?i:navigator.userAgent.match(/webkit/i)||navigator.userAgent.match(/(iPod|iPhone|iPad)/)?s:o+i,l+="</div>",l+='<div class="media-comment">',l+='<div class="media">',l+='  <a href="https://instagram.com/'+a.data.username+'" class="media-object thumbnail pull-left">',l+='    <img src="'+a.data.profile_picture+'" width="'+a.dflt.picture_size+'" height="'+a.dflt.picture_size+'" class="">',l+="  </a>",l+='  <div class="modal-body">',l+='      <h5 class="media-heading">',l+='        <a href="https://instagram.com/'+a.data.username+'">'+a.data.username+"</a>",l+="      </h5>",null!==a.data.caption?l+="      <p>"+a.data.caption+"</p>":"",l+="  </div>",l+="</div>",0!==a.data.comments_count?t.each(a.data.comments_data,function(t,e){l+='<div class="media">',l+='  <a href="https://instagram.com/'+e.from.username+'" class="media-object thumbnail pull-left">',l+='    <img src="'+e.from.profile_picture+'" width="'+a.dflt.picture_size+'" height="'+a.dflt.picture_size+'">',l+="  </a>",l+='  <div class="modal-body">',l+='      <h5 class="media-heading">',l+='        <a href="https://instagram.com/'+e.from.username+'">'+e.from.username+"</a>",l+="      </h5>",l+="      <p>"+e.text+"</p>",l+="  </div>",l+="</div>"}):"",l+="        </div>",l+="      </div>",l+="    </div>",l+="  </div>",l+="</div>",t("#triggr-"+a.data.id).on("click",function(o){o.preventDefault(),t("body").append(l),t("#"+a.data.id).modal("show").on("shown.bs.modal",function(){var t=document.getElementById(a.data.id+"-video");e.prototype.preloadMedia({imgid:"#"+a.data.id+"-full",loadr:"#"+a.data.id+"-full-loadr"}),e.prototype.videoBtn({trigger:"#play-pause",child:"i",classes:"glyphicon-play glyphicon-pause"},function(){t.paused===!0?t.play():t.pause()}),e.prototype.videoBtn({trigger:"#mute",child:"i",classes:"glyphicon-volume-up glyphicon-volume-off"},function(){t.muted===!1?t.muted=!0:t.muted=!1})}).on("hidden.bs.modal",function(){t(this).remove()})})}},e.prototype.preloadMedia=function(e){var a=t(e.imgid),o=0;a.one("load",function(){++o===a.length&&t(e.loadr).fadeOut(),t(this).addClass("fade")}).each(function(){this.complete&&t(this).load()})},e.prototype.videoBtn=function(e,a){t(e.trigger).on("click",function(o){o.preventDefault(),a(),t(e.child,this).toggleClass(e.classes)})},e.prototype.stream=function(){function a(e){void 0===e.url||null===e.url?t("[data-paginate="+e.show+"]").on("click",function(e){t(this).removeClass().addClass("btn btn-default").attr("disabled","disabled"),e.preventDefault()}):t("[data-paginate="+e.show+"]").on("click",function(a){a.preventDefault(),s({url:e.url,opt:e.opt}),t(this).unbind(a)})}function o(a,o){t.each(a,function(t,a){var i=new Date(1e3*a.created_time),s=i.toDateString(),n={dflt:o,target:l,data:{id:a.id,type:a.type,video:a.videos&&a.videos.standard_resolution.url,image:a.images.standard_resolution.url,caption:a.caption&&a.caption.text,username:a.user.username,timestamp:s,thumbnail:a.images.low_resolution.url,likes_count:a.likes.count,comments_count:a.comments.count,comments_data:a.comments.data,profile_picture:a.user.profile_picture}};e.prototype.template.thumb(n),e.prototype.preloadMedia({imgid:"#"+o.show+"-"+a.id+"-thmb",loadr:"#"+o.show+"-"+a.id+"-thmb-loadr"}),e.prototype.template.bsmodal(n)})}function i(t,a){e.prototype.template.profile({target:l,bio:t.bio,media:t.counts.media,website:t.website,follows:t.counts.follows,username:t.username,full_name:t.full_name,followed_by:t.counts.followed_by,picture_size:a.picture_size,profile_bg_img:a.profile_bg_img,profile_picture:t.profile_picture,profile_bg_color:a.profile_bg_color})}function s(e){t.ajax({url:e.url,cache:!0,method:"GET",dataType:"jsonp",success:function(t){"profile"!==e.opt.show?o(t.data,e.opt):i(t.data,e.opt),"profile"!==e.opt.show&&a({show:e.opt.show,url:t.pagination.next_url,opt:e.opt})}})}var l=this.element,n=this.options,d="https://api.instagram.com/v1/users/",c="?count="+n.count+"&access_token="+n.accessToken;switch(n.show){case"liked":s({url:d+"self/media/liked"+c,opt:n});break;case"feed":s({url:d+"self/feed"+c,opt:n});break;case"profile":s({url:d+n.accessId+"?access_token="+n.accessToken,opt:n});break;case"recent":s({url:d+n.accessId+"/media/recent"+c,opt:n});break;default:s({url:"https://api.instagram.com/v1/tags/"+n.show+"/media/recent"+c,opt:n})}},e.prototype.create=function(){var a=this.element,o=this.options;t(a).attr("data-type",o.show).addClass("pongstagrm row"),"profile"!==o.show&&e.prototype.template.loadmore({show:o.show,target:a,button:o.button,buttontext:o.buttontext}),this.stream()},e.prototype.start=function(){var t=this.options;return null!==t.accessId||null!==t.accessToken?void this.create():void 0},t.fn.pongstgrm=function(a){var o=t.extend({},e.defaults,a);return this.each(function(){var a=new e(t(this)[0],o);a.start()})},t.fn.pongstgrm.defaults=e.options}(window.jQuery);
